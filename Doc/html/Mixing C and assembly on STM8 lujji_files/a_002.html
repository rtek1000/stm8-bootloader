<!DOCTYPE html>
<!--[if IE 8]><html lang="en" dir="ltr" class="ie8"><![endif]-->
<!--[if IE 9]><html lang="en" dir="ltr" class="ie9"><![endif]-->
<!--[if gt IE 9]><!-->
<html dir="ltr" class="js no-touch localstorage sessionstorage contenteditable use-opacity-transitions embed-refresh embed-refresh-v2" style="--publisher-color: rgb(37,143,184); --publisher-color-safe: rgb(37,143,184);" lang="en"><!--<![endif]--><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <title>Disqus Comments</title>

    
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <style>
        .alert--warning {
            border-radius: 3px;
            padding: 10px 15px;
            margin-bottom: 10px;
            background-color: #FFE070;
            color: #A47703;
        }

        .alert--warning a,
        .alert--warning a:hover,
        .alert--warning strong {
            color: #A47703;
            font-weight: bold;
        }

        .alert--error p,
        .alert--warning p {
            margin-top: 5px;
            margin-bottom: 5px;
        }
        
        </style>
    
    <style>
        
        html {
            overflow: hidden;
        }
        

        #error {
            display: none;
        }

        .clearfix:after {
            content: "";
            display: block;
            height: 0;
            clear: both;
            visibility: hidden;
        }

        
    </style>

<script crossorigin="anonymous" id="bootstrap-script" data-app="lounge" src="a_data_002/lounge.load.00fde7e349e9ee2566c5f117c45abf06.js"></script><meta http-equiv="Content-Security-Policy" content="script-src https:;"><link rel="stylesheet" href="a_data_002/lounge.cef06fba9afb581ee691b2d4ff616400.css"><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="lounge/main" src="a_data_002/lounge.bundle.b29dff8af22e68239aefa0cfa712236c.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="remote/config" src="a_data_002/config.js"></script><style id="css_1681276760792"></style><!-- base href="https://disqus.com/embed/comments/?base=default&f=lujji&t_u=http%3A%2F%2Flujji.github.io%2Fblog%2Fmixing-c-and-assembly-on-stm8%2F&t_d=%0A%20%20%20%20%20%20Mixing%20C%20and%20assembly%20on%20STM8%0A%20%20%20%20&t_t=%0A%20%20%20%20%20%20Mixing%20C%20and%20assembly%20on%20STM8%0A%20%20%20%20&s_o=default" --><style type="text/css">@import url("https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,400;0,500;0,600;0,700;1,400;1,700&display=swap"); body.roboto , body.roboto input, body.roboto select, body.roboto textarea { font-family: Roboto, sans-serif; }</style></head>
<body class="roboto dark-anchor">
    

    
    <div id="error" class="alert--error">
        <p>We were unable to load Disqus. If you are a moderator please see our <a href="https://docs.disqus.com/help/83/"> troubleshooting guide</a>. </p>
    </div>

    
    <script type="text/json" id="disqus-forumData">{"session":{"canModerate":false,"audienceSyncVerified":false,"canReply":true,"mustVerify":false,"recaptchaPublicKey":"6Lfx6u0SAAAAAI1QkeTW397iQv1MsBfbDaYlwxK_","mustVerifyEmail":false},"forum":{"aetBannerConfirmation":null,"founder":"223501655","twitterName":null,"commentsLinkOne":"1 Comment","guidelines":null,"favicon":{"permalink":"https://disqus.com/api/forums/favicons/lujji.jpg","cache":"//a.disquscdn.com/1671639122/images/favicon-default.png"},"commentsLinkZero":"0 Comments","disableDisqusBranding":false,"id":"lujji","createdAt":"2016-09-17T08:44:29.135045","category":"Tech","aetBannerEnabled":false,"aetBannerTitle":null,"raw_guidelines":null,"initialCommentCount":null,"votingType":null,"daysUnapproveNewUsers":null,"installCompleted":false,"moderatorBadgeText":"","commentPolicyText":null,"aetEnabled":false,"channel":null,"sort":4,"description":null,"newPolicy":true,"raw_description":null,"customFont":null,"language":"en","adsReviewStatus":2,"commentsPlaceholderTextEmpty":null,"daysAlive":0,"forumCategory":{"date_added":"2016-01-28T01:54:31","id":8,"name":"Tech"},"linkColor":null,"colorScheme":"auto","pk":"4554663","commentsPlaceholderTextPopulated":null,"permissions":{},"commentPolicyLink":null,"aetBannerDescription":null,"name":"lujji's blog","commentsLinkMultiple":"{num} Comments","settings":{"threadRatingsEnabled":false,"adsDRNativeEnabled":false,"behindClickEnabled":false,"disable3rdPartyTrackers":true,"adsVideoEnabled":false,"adsProductVideoEnabled":false,"adsPositionTopEnabled":false,"ssoRequired":false,"unapproveLinks":false,"adsPositionRecommendationsEnabled":false,"linkAffiliationEnabled":false,"adsProductLinksThumbnailsEnabled":false,"hasCustomAvatar":false,"organicDiscoveryEnabled":false,"adsProductDisplayEnabled":false,"adsProductLinksEnabled":false,"audienceSyncEnabled":false,"threadReactionsEnabled":false,"adsEnabled":false,"disableSocialShare":false,"allowAnonPost":false,"adsProductStoriesEnabled":false,"sidebarEnabled":false,"adultContent":false,"allowAnonVotes":false,"gifPickerEnabled":true,"mustVerify":true,"badgesEnabled":false,"mustVerifyEmail":true,"unapproveNewUsersEnabled":false,"mediaembedEnabled":true,"userIdentityDisabled":false,"adsPositionBottomEnabled":false,"discoveryLocked":false,"validateAllPosts":false,"adsSettingsLocked":false,"isVIP":false,"adsPositionInthreadEnabled":false},"organizationId":3396437,"typeface":"auto","url":"http://lujji.github.io/blog","daysThreadAlive":0,"avatar":{"small":{"permalink":"https://disqus.com/api/forums/avatars/lujji.jpg?size=32","cache":"//a.disquscdn.com/1671639122/images/noavatar32.png"},"large":{"permalink":"https://disqus.com/api/forums/avatars/lujji.jpg?size=92","cache":"//a.disquscdn.com/1671639122/images/noavatar92.png"}},"signedUrl":"http://disq.us/?url=http%3A%2F%2Flujji.github.io%2Fblog&key=rRqx_aWyIoIe901vX2q7mA"}}</script>

    <script type="text/json" id="disqus-threadData">{"cursor":{"hasPrev":false,"prev":null,"total":6,"hasNext":false,"next":"1:0:0"},"code":0,"response":{"lastModified":1565763574,"posts":[{"editableUntil":"2017-08-09T21:59:59","dislikes":0,"thread":"6020240273","numReports":0,"likes":1,"message":"\u003cp>Hi Lujji! Very nice post! Thanks for sharing it! BR, Alan\u003c/p>","id":"3448793006","createdAt":"2017-08-02T21:59:59","author":{"username":"disqus_lRaYKuxx3i","about":"","name":"Alan","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2013-06-18T17:40:16","profileUrl":"https://disqus.com/by/disqus_lRaYKuxx3i/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"57611256","avatar":{"permalink":"https://disqus.com/api/users/avatars/disqus_lRaYKuxx3i.jpg","xlarge":{"permalink":"https://disqus.com/api/users/avatars/disqus_lRaYKuxx3i.jpg","cache":"https://c.disquscdn.com/uploads/users/5761/1256/avatar128.jpg?1616531574"},"cache":"https://c.disquscdn.com/uploads/users/5761/1256/avatar92.jpg?1616531574","large":{"permalink":"https://disqus.com/api/users/avatars/disqus_lRaYKuxx3i.jpg","cache":"https://c.disquscdn.com/uploads/users/5761/1256/avatar92.jpg?1616531574"},"small":{"permalink":"https://disqus.com/api/users/avatars/disqus_lRaYKuxx3i.jpg","cache":"https://c.disquscdn.com/uploads/users/5761/1256/avatar32.jpg?1616531574"},"isCustom":true}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":null,"isApproved":true,"isNewUserNeedsApproval":false,"isFlagged":false,"raw_message":"Hi Lujji! Very nice post! Thanks for sharing it! BR, Alan","isAtFlagLimit":false,"isHighlighted":false,"canVote":false,"forum":"lujji","depth":0,"points":1,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2017-12-15T11:44:24","dislikes":0,"thread":"6020240273","numReports":0,"likes":0,"message":"\u003cp>Well done! Big help for start. I'm still struggling on UART1, setup is OK, isr (minimal :) also working. Now I'm trying to connect using circular buffers, long time ago I have use that for MCS51 (not SDCC). But it was written in pure assembler, where I can put buffers on boundaries, which is quite effective when you calculate modulo for indexes. Have you seen some trick for absolute allocation? \u003cbr>I even try \"__code __at (0x9ff0) char Id[5] = \u201dSDCC\u201d;\" aimed from SDCC manual, but it gives me \"syntax error: token -&gt; '__at'. Using .area and .org from assembler is hopeless :(\u003c/p>","id":"3652449022","createdAt":"2017-12-08T11:44:24","author":{"username":"disqus_zUDsoIMuYQ","about":"","name":"tovis","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2017-11-22T22:09:32","profileUrl":"https://disqus.com/by/disqus_zUDsoIMuYQ/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"271992919","avatar":{"permalink":"https://disqus.com/api/users/avatars/disqus_zUDsoIMuYQ.jpg","xlarge":{"permalink":"https://disqus.com/api/users/avatars/disqus_zUDsoIMuYQ.jpg","cache":"//a.disquscdn.com/1671639122/images/noavatar128.png"},"cache":"//a.disquscdn.com/1671639122/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/disqus_zUDsoIMuYQ.jpg","cache":"//a.disquscdn.com/1671639122/images/noavatar92.png"},"small":{"permalink":"https://disqus.com/api/users/avatars/disqus_zUDsoIMuYQ.jpg","cache":"//a.disquscdn.com/1671639122/images/noavatar32.png"},"isCustom":false}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":null,"isApproved":true,"isNewUserNeedsApproval":false,"isFlagged":false,"raw_message":"Well done! Big help for start. I'm still struggling on UART1, setup is OK, isr (minimal :) also working. Now I'm trying to connect using circular buffers, long time ago I have use that for MCS51 (not SDCC). But it was written in pure assembler, where I can put buffers on boundaries, which is quite effective when you calculate modulo for indexes. Have you seen some trick for absolute allocation? \nI even try \"__code __at (0x9ff0) char Id[5] = \u201dSDCC\u201d;\" aimed from SDCC manual, but it gives me \"syntax error: token -> '__at'. Using .area and .org from assembler is hopeless :(","isAtFlagLimit":false,"isHighlighted":false,"canVote":false,"forum":"lujji","depth":0,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2017-12-16T15:52:06","dislikes":0,"thread":"6020240273","numReports":0,"likes":0,"message":"\u003cp>I don't think that \"code\" attribute is implemented for STM8 port. You can try \u003ccode>__at(0x9ff0) char id[5]\u003c/code> if you want to tell the compiler where to place the variable in program memory. But since you're talking about buffers, I assume that you'll be accessing them from RAM, not flash.\u003c/p>","id":"3654250701","createdAt":"2017-12-09T15:52:06","author":{"username":"disqus_Dga2cDKSKa","about":"","name":"lujji","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2016-09-17T12:36:59","profileUrl":"https://disqus.com/by/disqus_Dga2cDKSKa/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"223501655","avatar":{"permalink":"https://disqus.com/api/users/avatars/disqus_Dga2cDKSKa.jpg","xlarge":{"permalink":"https://disqus.com/api/users/avatars/disqus_Dga2cDKSKa.jpg","cache":"//a.disquscdn.com/1671639122/images/noavatar128.png"},"cache":"//a.disquscdn.com/1671639122/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/disqus_Dga2cDKSKa.jpg","cache":"//a.disquscdn.com/1671639122/images/noavatar92.png"},"small":{"permalink":"https://disqus.com/api/users/avatars/disqus_Dga2cDKSKa.jpg","cache":"//a.disquscdn.com/1671639122/images/noavatar32.png"},"isCustom":false}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":3652449022,"isApproved":true,"isNewUserNeedsApproval":false,"isFlagged":false,"raw_message":"I don't think that \"code\" attribute is implemented for STM8 port. You can try \u003ccode>__at(0x9ff0) char id[5]\u003c/code> if you want to tell the compiler where to place the variable in program memory. But since you're talking about buffers, I assume that you'll be accessing them from RAM, not flash.","isAtFlagLimit":false,"isHighlighted":false,"canVote":false,"forum":"lujji","depth":1,"points":0,"moderationLabels":[],"isEdited":true,"sb":false},{"editableUntil":"2017-12-17T11:58:25","dislikes":0,"thread":"6020240273","numReports":0,"likes":0,"message":"\u003cp>How you know that, the \"code\" attribute does not implemented? \"__at\" without CODE or DATA is work, even for SRAM/DATA area - at least I do not have syntax errors. I can not see these values \"DATA\" in map file, all about 26 bytes have attributes (REL,CON) - what means for me that absolute data was not placed at marked places :(\u003cbr>By the way, after coding simple circular buffer and see what compiler done (in asm file), I have decided rewrite hole thing in assembler. I love stm8 addressing modes, a specially ([longptr.w],X) \"Long Pointer Indirect Long Indexed addressing mode\" is amazing for me!\u003cbr>Using asm files created by compiler, I have see that int return values are awaited in X register (I have not tried but pointers too), and type as uint_8 awaited in A. This is could be correct? It is consistent? (I do not see it in the manual, mostly they talk about inline assembler).\u003c/p>","id":"3655426479","createdAt":"2017-12-10T11:58:25","author":{"username":"disqus_zUDsoIMuYQ","about":"","name":"tovis","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2017-11-22T22:09:32","profileUrl":"https://disqus.com/by/disqus_zUDsoIMuYQ/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"271992919","avatar":{"permalink":"https://disqus.com/api/users/avatars/disqus_zUDsoIMuYQ.jpg","xlarge":{"permalink":"https://disqus.com/api/users/avatars/disqus_zUDsoIMuYQ.jpg","cache":"//a.disquscdn.com/1671639122/images/noavatar128.png"},"cache":"//a.disquscdn.com/1671639122/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/disqus_zUDsoIMuYQ.jpg","cache":"//a.disquscdn.com/1671639122/images/noavatar92.png"},"small":{"permalink":"https://disqus.com/api/users/avatars/disqus_zUDsoIMuYQ.jpg","cache":"//a.disquscdn.com/1671639122/images/noavatar32.png"},"isCustom":false}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":3654250701,"isApproved":true,"isNewUserNeedsApproval":false,"isFlagged":false,"raw_message":"How you know that, the \"code\" attribute does not implemented? \"__at\" without CODE or DATA is work, even for SRAM/DATA area - at least I do not have syntax errors. I can not see these values \"DATA\" in map file, all about 26 bytes have attributes (REL,CON) - what means for me that absolute data was not placed at marked places :(\nBy the way, after coding simple circular buffer and see what compiler done (in asm file), I have decided rewrite hole thing in assembler. I love stm8 addressing modes, a specially ([longptr.w],X) \"Long Pointer Indirect Long Indexed addressing mode\" is amazing for me!\nUsing asm files created by compiler, I have see that int return values are awaited in X register (I have not tried but pointers too), and type as uint_8 awaited in A. This is could be correct? It is consistent? (I do not see it in the manual, mostly they talk about inline assembler).","isAtFlagLimit":false,"isHighlighted":false,"canVote":false,"forum":"lujji","depth":2,"points":0,"moderationLabels":[],"isEdited":true,"sb":false},{"editableUntil":"2017-08-10T16:37:10","dislikes":0,"thread":"6020240273","numReports":0,"likes":0,"message":"\u003cp>Well done, ny friend!  I loved to code pure Z80 assembly being a child and your article reminds me of my past. Now I'm trying to learn stm8 and effective programming of them in C language simultaneously. I hope Philipp Klaus Krause and Ben Shi (official STM8 SDCC maintainers) will read your articles and wil make sdcc more optimized in the very core.\u003c/p>\u003cp>Frankly speaking, I was thinking than sdcc is as bad as people say about it. Until one day I've tried one of the best, very expensive for commercial use \"professional\" IAR STM8 compiler and found out it's not that good either: With the best optimization possible\u003c/p>\u003cp>    return a ^= (1 &lt;&lt; 4);\u003c/p>\u003cp>was compiled into\u003c/p>\u003cp>    0080D6    01             RRWA      X, A\u003cbr>    0080D7    A810           XOR       A, #0x10\u003cbr>    0080D9    02             RLWA      X, A\u003cbr>    0080DA    81             RET\u003c/p>\u003cp>So that's why I've never coded in C for small systems before. And that's why I love your blogs cause bare metal coding allows us at least not to waste resources to crappy libraries and wrappers.\u003c/p>","id":"3449967287","createdAt":"2017-08-03T16:37:10","author":{"username":"disqus_mMEnKVg9HP","about":"","name":"\u0410\u043d\u043d\u0430 \u041c\u0430\u043a\u0430\u0440\u043e\u0432\u0430","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2017-03-08T19:59:20","profileUrl":"https://disqus.com/by/disqus_mMEnKVg9HP/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"244831312","avatar":{"permalink":"https://disqus.com/api/users/avatars/disqus_mMEnKVg9HP.jpg","xlarge":{"permalink":"https://disqus.com/api/users/avatars/disqus_mMEnKVg9HP.jpg","cache":"//a.disquscdn.com/1671639122/images/noavatar128.png"},"cache":"//a.disquscdn.com/1671639122/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/disqus_mMEnKVg9HP.jpg","cache":"//a.disquscdn.com/1671639122/images/noavatar92.png"},"small":{"permalink":"https://disqus.com/api/users/avatars/disqus_mMEnKVg9HP.jpg","cache":"//a.disquscdn.com/1671639122/images/noavatar32.png"},"isCustom":false}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":null,"isApproved":true,"isNewUserNeedsApproval":false,"isFlagged":false,"raw_message":"Well done, ny friend!  I loved to code pure Z80 assembly being a child and your article reminds me of my past. Now I'm trying to learn stm8 and effective programming of them in C language simultaneously. I hope Philipp Klaus Krause and Ben Shi (official STM8 SDCC maintainers) will read your articles and wil make sdcc more optimized in the very core.\n\nFrankly speaking, I was thinking than sdcc is as bad as people say about it. Until one day I've tried one of the best, very expensive for commercial use \"professional\" IAR STM8 compiler and found out it's not that good either: With the best optimization possible\n\n    return a ^= (1 \u003c\u003c 4);\n\nwas compiled into\n\n    0080D6    01             RRWA      X, A\n    0080D7    A810           XOR       A, #0x10\n    0080D9    02             RLWA      X, A\n    0080DA    81             RET\n\nSo that's why I've never coded in C for small systems before. And that's why I love your blogs cause bare metal coding allows us at least not to waste resources to crappy libraries and wrappers.","isAtFlagLimit":false,"isHighlighted":false,"canVote":false,"forum":"lujji","depth":0,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2017-08-14T16:36:48","dislikes":0,"thread":"6020240273","numReports":0,"likes":0,"message":"\u003cp>I don't think sdcc is bad. In fact, I think it's great since it's the only compiler that allows me to work with stm8 under linux.\u003c/p>","id":"3456178178","createdAt":"2017-08-07T16:36:48","author":{"username":"disqus_Dga2cDKSKa","about":"","name":"lujji","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2016-09-17T12:36:59","profileUrl":"https://disqus.com/by/disqus_Dga2cDKSKa/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"223501655","avatar":{"permalink":"https://disqus.com/api/users/avatars/disqus_Dga2cDKSKa.jpg","xlarge":{"permalink":"https://disqus.com/api/users/avatars/disqus_Dga2cDKSKa.jpg","cache":"//a.disquscdn.com/1671639122/images/noavatar128.png"},"cache":"//a.disquscdn.com/1671639122/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/disqus_Dga2cDKSKa.jpg","cache":"//a.disquscdn.com/1671639122/images/noavatar92.png"},"small":{"permalink":"https://disqus.com/api/users/avatars/disqus_Dga2cDKSKa.jpg","cache":"//a.disquscdn.com/1671639122/images/noavatar32.png"},"isCustom":false}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":3449967287,"isApproved":true,"isNewUserNeedsApproval":false,"isFlagged":false,"raw_message":"I don't think sdcc is bad. In fact, I think it's great since it's the only compiler that allows me to work with stm8 under linux.","isAtFlagLimit":false,"isHighlighted":false,"canVote":false,"forum":"lujji","depth":1,"points":0,"moderationLabels":[],"isEdited":false,"sb":false}],"thread":{"feed":"https://lujji.disqus.com/mixing_c_and_assembly_on_stm8/latest.rss","clean_title":"Mixing C and assembly on STM8","dislikes":0,"likes":0,"message":"","ratingsEnabled":false,"isSpam":false,"isDeleted":false,"category":"5471855","adsDisabled":false,"author":"223501655","id":"6020240273","signedLink":"http://disq.us/?url=http%3A%2F%2Flujji.github.io%2Fblog%2Fmixing-c-and-assembly-on-stm8%2F&key=XMPo9QhmV5KLv9emIHy4aA","createdAt":"2017-07-27T15:10:55","hasStreaming":false,"raw_message":"","isClosed":false,"link":"http://lujji.github.io/blog/mixing-c-and-assembly-on-stm8/","slug":"mixing_c_and_assembly_on_stm8","forum":"lujji","identifiers":[],"posts":6,"moderators":[223501655],"validateAllPosts":false,"title":"\n      Mixing C and assembly on STM8\n    ","highlightedPost":null}},"order":"popular"}</script>


    <div id="fixed-content"></div>


    
        
            
<script type="text/json" id="disqus-urls">{
    "root":"//disqus.com",
    "next":"https://c.disquscdn.com/next/current"
}</script>

        
        
        <script>!function () {
            var d = document;
            var toH = d.head.appendChild.bind(d.head);

            var v = window.location.href.match(/[#&?]version=([0-9a-f]{32})/);
            var src = 'https://c.disquscdn.com/next/embed/lounge.load';
            if (v)
                src += '.' + v[1];
            src += '.js';

            var s = d.createElement('script');
            s.crossOrigin = 'anonymous';
            s.id = 'bootstrap-script';
            s.setAttribute('data-app', 'lounge');
            s.src = src;
            toH(s);

            var m = d.createElement('meta');
            m.setAttribute('http-equiv', 'Content-Security-Policy');
            m.setAttribute('content', "script-src https:;");
            toH(m);
        }();</script>
    


<script src="a_data_002/common.bundle.6719fe9dbe70a5a047052a905ea1cbc5.js"></script><div id="layout" data-tracking-area="layout"><div id="thread__container"><div><div id="thread__wrapper"><div id="placement-top" data-tracking-area="discovery-north"></div><div id="onboard" data-tracking-area="onboard"></div><div id="reactions__container"></div><div id="ratings__container"></div><div id="badges-message__container"></div><div id="global-alert"></div><div id="tos__container"></div><header id="main-nav" data-tracking-area="main-nav"><div><nav class="nav nav-primary nav-primary--refresh"><ul><li class="nav-tab nav-tab--primary tab-conversation tab-conversation--refresh active" data-role="post-count"><a class="publisher-nav-color"><span class="comment-count">6 comments</span></a></li><li class="nav-tab nav-tab--primary tab-user"><ul><li class="nav-tab nav-tab--primary notification-menu unread" data-role="notification-menu" style="display: list-item;"><a href="https://disqus.com/home/inbox/" class="notification-container" data-action="home" data-home-path="home/notifications/"><span class="notification-icon notification-icon--refresh icon-comment" aria-hidden="true"></span><span class="notification-count notification-count--refresh" data-role="notification-count">1</span></a></li><li class="nav-tab nav-tab--primary dropdown user-menu media-collapsed" data-role="logout"><a href="#" class="dropdown-toggle dropdown-toggle--refresh" data-toggle="dropdown" role="menuitem" name="Login"><span class="dropdown-toggle-wrapper"><span class="username username--refresh">Login</span> </span> <span class="caret caret--refresh"></span></a><ul class="dropdown-menu dropdown-menu--refresh"><li><a href="#" data-action="auth:disqus">Disqus</a></li><li><a href="#" data-action="auth:facebook">Facebook</a></li><li><a href="#" data-action="auth:twitter">Twitter</a></li><li><a href="#" data-action="auth:google">Google</a></li></ul></li></ul></li></ul></nav></div></header><section id="conversation" data-role="main" data-tracking-area="main"><div id="posts"><div id="form" class="textarea-outer-wrapper--top-level"><form class="reply form-refresh form-refresh-v2"><div class="postbox"><div role="alert"></div><div class="ratings-wrapper" data-role="ratings-container"></div><div class="compose-wrapper"><div class="avatar"><span class="user user--refresh"><div>G</div></span></div><div class="textarea-outer-wrapper textarea-outer-wrapper--refresh"><div class="textarea-wrapper" data-role="textarea" dir="auto"><div><span class="placeholder">Join the discussion…</span><div class="textarea" tabindex="0" role="textbox" aria-multiline="true" data-role="editable" style="overflow: auto; overflow-wrap: break-word; max-height: 350px;" aria-label="Join the discussion…" contenteditable="true"><p><br></p></div><div style="display: none;"><ul class="user-mention__list" id="user-mention-list"><li class="header user-mention__header"><h5>in this conversation</h5></li></ul></div></div><div data-role="drag-drop-placeholder" class="media-drag-hover" style="display: none;"><div class="drag-text">⬇ Drag and drop your images here to upload them.</div></div><div class="media-preview empty" data-role="media-preview"><ul data-role="media-progress-list"></ul>
<ul data-role="media-rich-list"></ul>
<div class="media-expanded empty" data-role="media-preview-expanded">
<img src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" data-role="media-preview-expanded-image" alt="Media preview placeholder">
</div>
</div><div class="edit-alert" role="postbox-alert"></div><div class="text-editor-container"><div class="post-actions"><div class="wysiwyg"><div class="gif-picker"><div class="wysiwyg__item" data-role="gif-picker-toggle" title="GIF" aria-label="Open GIF menu" tabindex="0"><div class="wysiwyg__gif" title="GIF" role="img"></div></div><div class="hidden gif-picker__popout-container" data-role="gif-picker-popout-container"></div><div class="new-feature-badge-star" title="New"><div class="wysiwyg__star-badge wysiwyg__star-badge-dims"></div></div></div><div class="media-uploader"><li class="wysiwyg__item" data-role="media-uploader" tabindex="-1"><a href="#" data-action="attach" class="attach" title="Upload Images" tabindex="0" aria-label="Open file attachment menu">
<div class="wysiwyg__attach wysiwyg__attach-dims" role="img"></div>
</a>
<input type="file" data-role="media-upload" tabindex="-1" accept="image/*">
</li></div><div class="vertical-separator"></div><div data-action="text-editor-buttons"><div class="wysiwyg__item" data-action="text-editor-tag" data-tag="b" tabindex="0" aria-label="Add bold tags to text editor"><div class="wysiwyg__bold" title="Bold" role="img"></div></div><div class="wysiwyg__item" data-action="text-editor-tag" data-tag="i" tabindex="0" aria-label="Add italics tags to text editor"><div class="wysiwyg__italic" title="Italic" role="img"></div></div><div class="wysiwyg__item" data-action="text-editor-tag" data-tag="u" tabindex="0" aria-label="Add underline tags to text editor"><div class="wysiwyg__underline" title="Underline" role="img"></div></div><div class="wysiwyg__item" data-action="text-editor-tag" data-tag="s" tabindex="0" aria-label="Add strikethrough tags to text editor"><div class="wysiwyg__strikethrough" title="Strikethrough" role="img"></div></div><div class="wysiwyg__item" data-action="text-editor-tag" data-tag="a" tabindex="0" aria-label="Add link tags to text editor"><div class="wysiwyg__link" title="Link" role="img"></div></div><div class="wysiwyg__item" data-action="text-editor-tag" data-tag="spoiler" tabindex="0" aria-label="Add spoiler tags to text editor"><div class="wysiwyg__spoiler" title="Spoiler" role="img"></div></div><div class="wysiwyg__item" data-action="text-editor-tag" data-tag="code" tabindex="0" aria-label="Add code tags to text editor"><div class="wysiwyg__code" title="Code" role="img"></div></div><div class="wysiwyg__item" data-action="text-editor-tag" data-tag="blockquote" tabindex="0" aria-label="Add block quote tags to text editor"><div class="wysiwyg__blockquote" title="Quote" role="img"></div></div></div></div><div class="logged-in"><section><div class="temp-post"><button type="submit" class="btn post-action__button full-size-button ">Comment</button><button type="submit" class="btn post-action__button small-size-button hidden">Comment</button></div></section></div></div></div></div></div></div><div data-role="login-form"><div><div><section class="auth-section logged-out__display"><div class="connect"><h6 class="connect__heading">Log in with</h6><ul data-role="login-menu" class="services login-buttons"><li class="auth-disqus"><button type="button" data-action="auth:disqus" title="Disqus" class="connect__button" aria-label="Login with Disqus"><i class="icon-disqus"></i></button></li><li class="auth-facebook"><button type="button" data-action="auth:facebook" title="Facebook" class="connect__button" aria-label="Login with Facebook"><i class="icon-facebook-circle"></i></button></li><li class="auth-twitter"><button type="button" data-action="auth:twitter" title="Twitter" class="connect__button" aria-label="Login with Twitter"><i class="icon-twitter-circle"></i></button></li><li class="auth-google"><button type="button" data-action="auth:google" title="Google" class="connect__button" aria-label="Login with Google"><i class="icon-google-plus-circle"></i></button></li></ul></div><div class="guest guest--refresh"><div class="sign-up-wrapper-refresh"><h6 class="guest-form-title guest-form-title--refresh"><span class="register-text"> or sign up with Disqus </span><span class="guest-text"> or pick a name </span></h6> <button type="button" class="help-tooltip__wrapper help-icon" name="guest_tooltip" tabindex="0"><div id="rules" class="help-tooltip__container" data-role="guest-form-tooltip"><div class="tooltip show help-tooltip"><h3 class="help-tooltip__heading">Disqus is a discussion network</h3><ul class="help-tooltip__list"><li><span>Don't be a jerk or do anything illegal. Everything is easier that way.</span></li></ul><p class="clearfix"><a href="https://docs.disqus.com/kb/terms-and-policies/" class="btn btn-small help-tooltip__button" rel="noopener noreferrer" target="_blank">Read full terms and conditions</a></p></div></div></button></div><p class="input-wrapper"><input dir="auto" type="text" placeholder="Name" name="display_name" id="view41_display_name" maxlength="30" class="input--text" aria-label="name"></p><div class="guest-details " data-role="guest-details"><p class="input-wrapper"><input dir="auto" type="email" placeholder="Email" name="email" id="view41_email" class="input--text" aria-label="email"></p><p class="input-wrapper"><input dir="auto" disabled="disabled" type="text" class="register-text input--text" placeholder="Password" name="password" aria-label="password" id="view41_password"></p><div class="acceptance-wrapper"><p><label><input type="checkbox" name="tos"><span class="spacing-left-small">I agree to Disqus' <a href="https://help.disqus.com/customer/portal/articles/466260-terms-of-service" target="_blank" rel="noopener noreferrer">Terms of Service</a></span></label></p><p><label><input type="checkbox" name="privacy-policy"><span class="spacing-left-small">I
 agree to Disqus' processing of email and IP address, and the use of 
cookies, to facilitate my authentication and posting of comments, 
explained further in the <a href="https://help.disqus.com/customer/portal/articles/466259-privacy-policy" target="_blank" rel="noopener noreferrer">Privacy Policy</a></span></label></p><p><label><input type="checkbox" name="data-sharing"><span class="spacing-left-small">I
 agree to additional processing of my information, including first and 
third party cookies, for personalized content and advertising as 
outlined in our <a href="https://disqus.com/data-sharing-settings/">Data Sharing Policy</a></span></label></p></div><input type="checkbox" name="author-guest" style="display: none;"><div class="g-recaptcha" data-role="grecaptcha-container"></div><div class="proceed" data-role="submit-btn-container"><button type="submit" class="proceed__button btn submit" aria-label="Next"><span class="icon-proceed"></span><div class="spinner"></div></button></div></div></div></section></div></div></div></div></form></div><div id="email-signup"></div><div id="secondary-navigation"><div data-tracking-area="secondary-nav" class="nav-secondary-refresh"><ul class="nav-secondary-refresh__list"><li class="nav-secondary-refresh__list-item"><div id="favorite-button"><div class="thread-likes"><div><a href="#" data-action="favorite" title="Favorite this discussion" class="favorite-button-toggle favorite-button-toggle--v2 " aria-label="Favorite this discussion"><span class="label label-default"><span class="favorite-icon favorite-icon--refresh-v2 icon-heart-empty"></span></span><span class="label label-favorited"><span class="favorite-icon favorite-icon--refresh-v2 icon-heart"></span></span> </a><ul class="dropdown-menu dropdown-menu--coachmark pull-right"><li><div><h2 class="coachmark__heading">Discussion Favorited!</h2><p class="coachmark__description">Favoriting means this is a discussion worth sharing. It gets shared to your followers' Disqus feeds, and gives the creator kudos!</p></div> <a href="https://disqus.com/home/?utm_source=disqus_embed&amp;utm_content=recommend_btn" class="btn btn-primary coachmark__button" target="_blank" rel="noopener noreferrer">Find More Discussions</a></li></ul></div></div></div><div id="thread-share-bar" class="share-bar-refresh"><div class="thread-share-wrapper"><div class="round-delimiter"></div><span data-role="thread-share" class="thread-share-bar-buttons-refresh"><a href="#" class="share-button-toggle share-button-toggle--v2" data-toggle="dropdown" aria-label="Share">Share</a><ul class="share-dropdown-refresh"><li class="share-dropdown-refresh__item"><div class="share-icons-wrapper share-icons-wrapper--twitter" data-action="share:twitter"><span class="icon-twitter" aria-hidden="true"></span><span class="visually-hidden">Tweet this discussion</span></div></li><li class="share-dropdown-refresh__item"><div class="share-icons-wrapper share-icons-wrapper--facebook" data-action="share:facebook"><span class="icon-facebook" aria-hidden="true"></span><span class="visually-hidden">Share this discussion on Facebook</span></div></li></ul></span></div></div></li><li data-role="post-sort" class=""><ul class="sort-menu-refresh"><li class="sort-menu-refresh__item selected"><a href="#" data-action="sort" data-sort="popular">Best</a></li><li class="sort-menu-refresh__item "><a href="#" data-action="sort" data-sort="desc">Newest</a></li><li class="sort-menu-refresh__item "><a href="#" data-action="sort" data-sort="asc">Oldest</a></li></ul></li></ul></div></div><div id="no-posts" style="display: none;"></div><div id="highlighted-post" data-tracking-area="highlighted" class="highlighted-post" style="display: none;"></div><button class="alert alert--realtime alert--realtime--refresh alert--realtime--refresh-v2" style="display: none;" data-role="realtime-notification"></button><ul id="post-list" class="post-list"><li class="post" id="post-3448793006"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><span class="pinned-icon"></span><ul class="post-menu dropdown post-menu--refresh" data-role="menu" data-view-id="post-menu" data-post-id="3448793006"><li class="post-menu-item collapse"><a href="#" data-action="collapse" title="Collapse" name="Collapse"><span>−</span></a></li><li class="post-menu-item expand"><a href="#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/disqus_lRaYKuxx3i/" data-action="profile" data-tab="" data-username="disqus_lRaYKuxx3i" target="_blank" rel="noopener noreferrer" class="user user--refresh"><img data-role="user-avatar" data-user="57611256" src="a_data_002/avatar92.jpg" alt="Avatar" class="image-refresh"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_lRaYKuxx3i/" data-action="profile" data-tab="" data-username="disqus_lRaYKuxx3i" target="_blank" rel="noopener noreferrer">Alan</a></span> <a data-action="follow" data-user="57611256" class="follow-user-container" tabindex="0"><span class="follow-user" aria-label="Follow" title="Follow"></span></a></span></span>  <span class="post-meta" style="display: block;"> <a href="https://lujji.github.io/blog/mixing-c-and-assembly-on-stm8/#comment-3448793006" data-role="relative-time" class="time-ago" title="Wednesday, August 2, 2017 6:59 PM">6 years ago</a> </span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Hi Lujji! Very nice post! Thanks for sharing it! BR, Alan</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="#" class="vote-up  count-1" data-action="upvote" title="" name="Vote up"><span class="control"></span> <span class="updatable count" data-role="likes">1</span></a><a href="#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li id="comment__share-3448793006" class="comment__share"><a class="toggle" href="#" data-action="expand-share"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter share__button-container"><button class="share__button icon icon-twitter" data-action="share:twitter" aria-label="Share comment on Twitter"></button></li><li class="facebook share__button-container"><button class="share__button icon icon-facebook" data-action="share:facebook" aria-label="Share comment on Facebook"></button></li></div><li class="link share__button-container"><button class="share__button icon icon-link" value="http://disq.us/p/1l1blpq" name="Link" title="Click to copy post link" data-action="copy-link" aria-label="Copy link to comment"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/1l1blpq"></li></ul></li><li class="realtime" data-role="realtime-notification:3448793006"><span style="display: none;" class="realtime-replies realtime-replies--refresh icon icon-pencil"></span><a style="display: none;" href="#" class="realtime-button realtime-button--refresh"></a></li></menu></footer></div><div class="moderate-form blacklist-form" data-role="blacklist-form"></div><div class="moderate-form flag-form" data-role="flagging-form"></div><div class="badges-form" data-role="badges-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-3448793006-show-children" data-action="show-children" href="#">Show more replies</a></div></div></li><li class="post" id="post-3652449022"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><span class="pinned-icon"></span><ul class="post-menu dropdown post-menu--refresh" data-role="menu" data-view-id="post-menu" data-post-id="3652449022"><li class="post-menu-item collapse"><a href="#" data-action="collapse" title="Collapse" name="Collapse"><span>−</span></a></li><li class="post-menu-item expand"><a href="#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/disqus_zUDsoIMuYQ/" data-action="profile" data-tab="" data-username="disqus_zUDsoIMuYQ" target="_blank" rel="noopener noreferrer" class="user user--refresh"><div>T</div></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_zUDsoIMuYQ/" data-action="profile" data-tab="" data-username="disqus_zUDsoIMuYQ" target="_blank" rel="noopener noreferrer">tovis</a></span> <a data-action="follow" data-user="271992919" class="follow-user-container" tabindex="0"><span class="follow-user" aria-label="Follow" title="Follow"></span></a></span></span>  <span class="post-meta" style="display: block;"> <a href="https://lujji.github.io/blog/mixing-c-and-assembly-on-stm8/#comment-3652449022" data-role="relative-time" class="time-ago" title="Friday, December 8, 2017 9:44 AM">5 years ago</a> </span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Well
 done! Big help for start. I'm still struggling on UART1, setup is OK, 
isr (minimal :) also working. Now I'm trying to connect using circular 
buffers, long time ago I have use that for MCS51 (not SDCC). But it was 
written in pure assembler, where I can put buffers on boundaries, which 
is quite effective when you calculate modulo for indexes. Have you seen 
some trick for absolute allocation? <br>I even try "__code __at (0x9ff0)
 char Id[5] = ”SDCC”;" aimed from SDCC manual, but it gives me "syntax 
error: token -&gt; '__at'. Using .area and .org from assembler is 
hopeless :(</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="control"></span> <span class="updatable count" data-role="likes">0</span></a><a href="#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li id="comment__share-3652449022" class="comment__share"><a class="toggle" href="#" data-action="expand-share"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter share__button-container"><button class="share__button icon icon-twitter" data-action="share:twitter" aria-label="Share comment on Twitter"></button></li><li class="facebook share__button-container"><button class="share__button icon icon-facebook" data-action="share:facebook" aria-label="Share comment on Facebook"></button></li></div><li class="link share__button-container"><button class="share__button icon icon-link" value="http://disq.us/p/1oeknpa" name="Link" title="Click to copy post link" data-action="copy-link" aria-label="Copy link to comment"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/1oeknpa"></li></ul></li><li class="realtime" data-role="realtime-notification:3652449022"><span style="display: none;" class="realtime-replies realtime-replies--refresh icon icon-pencil"></span><a style="display: none;" href="#" class="realtime-button realtime-button--refresh"></a></li></menu></footer></div><div class="moderate-form blacklist-form" data-role="blacklist-form"></div><div class="moderate-form flag-form" data-role="flagging-form"></div><div class="badges-form" data-role="badges-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-3654250701"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><span class="pinned-icon"></span><ul class="post-menu dropdown post-menu--refresh" data-role="menu" data-view-id="post-menu" data-post-id="3654250701"><li class="post-menu-item collapse"><a href="#" data-action="collapse" title="Collapse" name="Collapse"><span>−</span></a></li><li class="post-menu-item expand"><a href="#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/disqus_Dga2cDKSKa/" data-action="profile" data-tab="" data-username="disqus_Dga2cDKSKa" target="_blank" rel="noopener noreferrer" class="user user--refresh"><div>L</div></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_Dga2cDKSKa/" data-action="profile" data-tab="" data-username="disqus_Dga2cDKSKa" target="_blank" rel="noopener noreferrer">lujji</a></span> <span class="badge moderator"><span class="badge-content">Mod</span></span><a data-action="follow" data-user="223501655" class="follow-user-container" tabindex="0"><span class="follow-user" aria-label="Follow" title="Follow"></span></a></span><span class="parent-link-container"> <a href="https://lujji.github.io/blog/mixing-c-and-assembly-on-stm8/#comment-3652449022" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> tovis</a></span></span>  <span class="post-meta" style="display: block;"> <a href="https://lujji.github.io/blog/mixing-c-and-assembly-on-stm8/#comment-3654250701" data-role="relative-time" class="time-ago" title="Saturday, December 9, 2017 1:52 PM">5 years ago</a> <span> <span class="has-edit" data-role="has-edit">edited</span></span></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>I don't think that "code" attribute is implemented for STM8 port. You can try <code>__at(0x9ff0) char id[5]</code>
 if you want to tell the compiler where to place the variable in program
 memory. But since you're talking about buffers, I assume that you'll be
 accessing them from RAM, not flash.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="control"></span> <span class="updatable count" data-role="likes">0</span></a><a href="#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li id="comment__share-3654250701" class="comment__share"><a class="toggle" href="#" data-action="expand-share"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter share__button-container"><button class="share__button icon icon-twitter" data-action="share:twitter" aria-label="Share comment on Twitter"></button></li><li class="facebook share__button-container"><button class="share__button icon icon-facebook" data-action="share:facebook" aria-label="Share comment on Facebook"></button></li></div><li class="link share__button-container"><button class="share__button icon icon-link" value="http://disq.us/p/1ofn9vx" name="Link" title="Click to copy post link" data-action="copy-link" aria-label="Copy link to comment"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/1ofn9vx"></li></ul></li><li class="realtime" data-role="realtime-notification:3654250701"><span style="display: none;" class="realtime-replies realtime-replies--refresh icon icon-pencil"></span><a style="display: none;" href="#" class="realtime-button realtime-button--refresh"></a></li></menu></footer></div><div class="moderate-form blacklist-form" data-role="blacklist-form"></div><div class="moderate-form flag-form" data-role="flagging-form"></div><div class="badges-form" data-role="badges-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-3655426479"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><span class="pinned-icon"></span><ul class="post-menu dropdown post-menu--refresh" data-role="menu" data-view-id="post-menu" data-post-id="3655426479"><li class="post-menu-item collapse"><a href="#" data-action="collapse" title="Collapse" name="Collapse"><span>−</span></a></li><li class="post-menu-item expand"><a href="#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/disqus_zUDsoIMuYQ/" data-action="profile" data-tab="" data-username="disqus_zUDsoIMuYQ" target="_blank" rel="noopener noreferrer" class="user user--refresh"><div>T</div></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_zUDsoIMuYQ/" data-action="profile" data-tab="" data-username="disqus_zUDsoIMuYQ" target="_blank" rel="noopener noreferrer">tovis</a></span> <a data-action="follow" data-user="271992919" class="follow-user-container" tabindex="0"><span class="follow-user" aria-label="Follow" title="Follow"></span></a></span><span class="parent-link-container"> <a href="https://lujji.github.io/blog/mixing-c-and-assembly-on-stm8/#comment-3654250701" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> lujji</a></span></span>  <span class="post-meta" style="display: block;"> <a href="https://lujji.github.io/blog/mixing-c-and-assembly-on-stm8/#comment-3655426479" data-role="relative-time" class="time-ago" title="Sunday, December 10, 2017 9:58 AM">5 years ago</a> <span> <span class="has-edit" data-role="has-edit">edited</span></span></span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>How
 you know that, the "code" attribute does not implemented? "__at" 
without CODE or DATA is work, even for SRAM/DATA area - at least I do 
not have syntax errors. I can not see these values "DATA" in map file, 
all about 26 bytes have attributes (REL,CON) - what means for me that 
absolute data was not placed at marked places :(<br>By the way, after 
coding simple circular buffer and see what compiler done (in asm file), I
 have decided rewrite hole thing in assembler. I love stm8 addressing 
modes, a specially ([longptr.w],X) "Long Pointer Indirect Long Indexed 
addressing mode" is amazing for me!<br>Using asm files created by 
compiler, I have see that int return values are awaited in X register (I
 have not tried but pointers too), and type as uint_8 awaited in A. This
 is could be correct? It is consistent? (I do not see it in the manual, 
mostly they talk about inline assembler).</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="control"></span> <span class="updatable count" data-role="likes">0</span></a><a href="#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li id="comment__share-3655426479" class="comment__share"><a class="toggle" href="#" data-action="expand-share"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter share__button-container"><button class="share__button icon icon-twitter" data-action="share:twitter" aria-label="Share comment on Twitter"></button></li><li class="facebook share__button-container"><button class="share__button icon icon-facebook" data-action="share:facebook" aria-label="Share comment on Facebook"></button></li></div><li class="link share__button-container"><button class="share__button icon icon-link" value="http://disq.us/p/1ogch4f" name="Link" title="Click to copy post link" data-action="copy-link" aria-label="Copy link to comment"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/1ogch4f"></li></ul></li><li class="realtime" data-role="realtime-notification:3655426479"><span style="display: none;" class="realtime-replies realtime-replies--refresh icon icon-pencil"></span><a style="display: none;" href="#" class="realtime-button realtime-button--refresh"></a></li></menu></footer></div><div class="moderate-form blacklist-form" data-role="blacklist-form"></div><div class="moderate-form flag-form" data-role="flagging-form"></div><div class="badges-form" data-role="badges-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-3655426479-show-children" data-action="show-children" href="#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-3654250701-show-children" data-action="show-children" href="#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-3652449022-show-children" data-action="show-children" href="#">Show more replies</a></div></div></li><li class="post" id="post-3449967287"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><span class="pinned-icon"></span><ul class="post-menu dropdown post-menu--refresh" data-role="menu" data-view-id="post-menu" data-post-id="3449967287"><li class="post-menu-item collapse"><a href="#" data-action="collapse" title="Collapse" name="Collapse"><span>−</span></a></li><li class="post-menu-item expand"><a href="#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/disqus_mMEnKVg9HP/" data-action="profile" data-tab="" data-username="disqus_mMEnKVg9HP" target="_blank" rel="noopener noreferrer" class="user user--refresh"><div>А</div></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_mMEnKVg9HP/" data-action="profile" data-tab="" data-username="disqus_mMEnKVg9HP" target="_blank" rel="noopener noreferrer">Анна Макарова</a></span> <a data-action="follow" data-user="244831312" class="follow-user-container" tabindex="0"><span class="follow-user" aria-label="Follow" title="Follow"></span></a></span></span>  <span class="post-meta" style="display: block;"> <a href="https://lujji.github.io/blog/mixing-c-and-assembly-on-stm8/#comment-3449967287" data-role="relative-time" class="time-ago" title="Thursday, August 3, 2017 1:37 PM">6 years ago</a> </span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Well
 done, ny friend!  I loved to code pure Z80 assembly being a child and 
your article reminds me of my past. Now I'm trying to learn stm8 and 
effective programming of them in C language simultaneously. I hope 
Philipp Klaus Krause and Ben Shi (official STM8 SDCC maintainers) will 
read your articles and wil make sdcc more optimized in the very core.</p><p>Frankly
 speaking, I was thinking than sdcc is as bad as people say about it. 
Until one day I've tried one of the best, very expensive for commercial 
use "professional" IAR STM8 compiler and found out it's not that good 
either: With the best optimization possible</p><p>    return a ^= (1 &lt;&lt; 4);</p><p>was compiled into</p><p>    0080D6    01             RRWA      X, A<br>    0080D7    A810           XOR       A, #0x10<br>    0080D9    02             RLWA      X, A<br>    0080DA    81             RET</p><p>So
 that's why I've never coded in C for small systems before. And that's 
why I love your blogs cause bare metal coding allows us at least not to 
waste resources to crappy libraries and wrappers.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="control"></span> <span class="updatable count" data-role="likes">0</span></a><a href="#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li id="comment__share-3449967287" class="comment__share"><a class="toggle" href="#" data-action="expand-share"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter share__button-container"><button class="share__button icon icon-twitter" data-action="share:twitter" aria-label="Share comment on Twitter"></button></li><li class="facebook share__button-container"><button class="share__button icon icon-facebook" data-action="share:facebook" aria-label="Share comment on Facebook"></button></li></div><li class="link share__button-container"><button class="share__button icon icon-link" value="http://disq.us/p/1l20rsn" name="Link" title="Click to copy post link" data-action="copy-link" aria-label="Copy link to comment"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/1l20rsn"></li></ul></li><li class="realtime" data-role="realtime-notification:3449967287"><span style="display: none;" class="realtime-replies realtime-replies--refresh icon icon-pencil"></span><a style="display: none;" href="#" class="realtime-button realtime-button--refresh"></a></li></menu></footer></div><div class="moderate-form blacklist-form" data-role="blacklist-form"></div><div class="moderate-form flag-form" data-role="flagging-form"></div><div class="badges-form" data-role="badges-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-3456178178"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><span class="pinned-icon"></span><ul class="post-menu dropdown post-menu--refresh" data-role="menu" data-view-id="post-menu" data-post-id="3456178178"><li class="post-menu-item collapse"><a href="#" data-action="collapse" title="Collapse" name="Collapse"><span>−</span></a></li><li class="post-menu-item expand"><a href="#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/disqus_Dga2cDKSKa/" data-action="profile" data-tab="" data-username="disqus_Dga2cDKSKa" target="_blank" rel="noopener noreferrer" class="user user--refresh"><div>L</div></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_Dga2cDKSKa/" data-action="profile" data-tab="" data-username="disqus_Dga2cDKSKa" target="_blank" rel="noopener noreferrer">lujji</a></span> <span class="badge moderator"><span class="badge-content">Mod</span></span><a data-action="follow" data-user="223501655" class="follow-user-container" tabindex="0"><span class="follow-user" aria-label="Follow" title="Follow"></span></a></span><span class="parent-link-container"> <a href="https://lujji.github.io/blog/mixing-c-and-assembly-on-stm8/#comment-3449967287" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Анна Макарова</a></span></span>  <span class="post-meta" style="display: block;"> <a href="https://lujji.github.io/blog/mixing-c-and-assembly-on-stm8/#comment-3456178178" data-role="relative-time" class="time-ago" title="Monday, August 7, 2017 1:36 PM">6 years ago</a> </span> </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>I
 don't think sdcc is bad. In fact, I think it's great since it's the 
only compiler that allows me to work with stm8 under linux.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="control"></span> <span class="updatable count" data-role="likes">0</span></a><a href="#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true">•</li><li id="comment__share-3456178178" class="comment__share"><a class="toggle" href="#" data-action="expand-share"><span class="text">Share ›</span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter share__button-container"><button class="share__button icon icon-twitter" data-action="share:twitter" aria-label="Share comment on Twitter"></button></li><li class="facebook share__button-container"><button class="share__button icon icon-facebook" data-action="share:facebook" aria-label="Share comment on Facebook"></button></li></div><li class="link share__button-container"><button class="share__button icon icon-link" value="http://disq.us/p/1l5pw5e" name="Link" title="Click to copy post link" data-action="copy-link" aria-label="Copy link to comment"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly="readonly" value="http://disq.us/p/1l5pw5e"></li></ul></li><li class="realtime" data-role="realtime-notification:3456178178"><span style="display: none;" class="realtime-replies realtime-replies--refresh icon icon-pencil"></span><a style="display: none;" href="#" class="realtime-button realtime-button--refresh"></a></li></menu></footer></div><div class="moderate-form blacklist-form" data-role="blacklist-form"></div><div class="moderate-form flag-form" data-role="flagging-form"></div><div class="badges-form" data-role="badges-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-3456178178-show-children" data-action="show-children" href="#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-3449967287-show-children" data-action="show-children" href="#">Show more replies</a></div></div></li></ul><div class="load-more-refresh load-more-refresh--v2" data-role="more" style="display: none;"><a href="#" data-action="more-posts" class="btn load-more-refresh__button ">Load more comments</a></div></div></section><div id="placement-bottom" data-tracking-area="discovery-south"></div><footer id="footer" data-tracking-area="footer" class="disqus-footer__wrapper disqus-footer__wrapper--refresh"><div><div class="disqus-footer disqus-footer--refresh"><ul class="disqus-footer__list"><li id="thread-subscribe-button" class="email disqus-footer__item disqus-footer__item--refresh"><div class="default"><a href="#" rel="nofollow" data-action="subscribe" title="Subscribe and get email updates from this discussion" class="disqus-footer__link disqus-footer__link--refresh"><div class="icon-wrapper"><i aria-hidden="true" class="icon-subscribe-refresh"></i></div><i aria-hidden="true" class="icon icon-checkmark"></i><span id="thread-subscribe-text-default" class="text-item">Subscribe</span><span id="thread-subscribe-text-subscribed" class="text-item hidden">Subscribed</span></a></div></li><li class="privacy disqus-footer__item disqus-footer__item--refresh"><a href="https://help.disqus.com/customer/portal/articles/466259-privacy-policy" rel="nofollow noopener noreferrer" target="_blank" class="disqus-footer__link disqus-footer__link--refresh" title="Privacy"><div class="icon-wrapper"><i aria-hidden="true" class="icon-privacy-refresh"></i></div><span class="text-item">Privacy</span></a></li><li class="do-not-sell disqus-footer__item disqus-footer__item--refresh"><a href="https://disqus.com/data-sharing-settings/" rel="nofollow noopener noreferrer" target="_blank" class="disqus-footer__link disqus-footer__link--refresh"><div class="icon-wrapper"><i aria-hidden="true" class="icon-warning-refresh"></i></div><span class="text-item">Do Not Sell My Data</span></a></li></ul><span class="disqus-footer__logo"><a href="https://disqus.com/" rel="nofollow" title="Powered by Disqus" class="disqus-footer__link disqus-footer__link--refresh">Powered by Disqus</a></span></div></div></footer></div></div></div></div></body></html>